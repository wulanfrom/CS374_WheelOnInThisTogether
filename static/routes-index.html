<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Find a route!</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link href="style/styleGuide.css" rel="stylesheet">
  <link href="components.css" rel="stylesheet">
  <link href="style/new_navbar.css" rel="stylesheet">
  <link href="style/new_homepage.css" rel="stylesheet">
  <link href="style/routes.css" rel="stylesheet">
</head>

<body>
  <div class="spinner">
    <div class="spinner-border text-warning" style="width: 3rem; height: 3rem;" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>

  <!-- Navigation Bar -->
  <nav class="navbar sticky-top shadow color-black p-0">
    <nav class="navbar navbar-expand-lg container mt-0 mb-0 p-0">
      <a class="navbar-brand ml-2" href="new_homepage.html">
        <img class="p-0" src="homepagePictures/website_logo.png" width="250" height="80" class="d-inline-block align-top pr-2" alt="">
      </a>

      <div class="collapse navbar-collapse d-flex justify-content-end pr-3" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link active" href="routes-index.html">Routes</a></li>
          <li class="nav-item pl-2"><a class="nav-link text-grey" href="search_rate.html">Rates</a></li>
          <li class="nav-item pl-2"><a class="nav-link text-grey" href="forum_mainpage.html">Forum</a></li>
        </ul>
      </div>

      <div class="dropdown">
        <a class="navbar-brand m" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="new_homepage.html">
          <img src="homepagePictures/duck.jpg" width="30" height="30" class="rounded-circle profile-pic d-inline-block align-top" alt="">
        </a>
        <div class="dropdown-menu text-center">Wheelie Wonka</div>
      </div>
    </nav>
  </nav>

  <div class="container mt-4" id="routes-index-main">
    <div class="row">
      <div class="col-md-4">
        <!-- Search form -->
        <div class="card shadow border-0 p-4 mb-4 routes-card">
          <form>
            <div class="form-group routes-form">
              <label for="fromPlace">FROM</label><br>
              <input placeholder="I want to go from ..." class="input_default routes-input form-control" id="fromPlace">
            </div>
            <img src="icons/arrow-down-up.svg" class="arrow-up-down float-right" alt="arrow-up-down-logo">
            <div class="form-group">
              <label for="toPlace">TO</label><br>
              <input placeholder="I want to go to ..." class="input_default routes-input form-control" id="toPlace">
            </div>
            <button type="button" class="btn color-yellow mt-2 border-0 text-black" id="addRouteButton">ADD ROUTE</button>
            <button type="button" class="btn color-yellow mt-2 border-0 text-black float-right" id="searchRouteButton">SEARCH ROUTE</button>
          </form>
        </div>

        <div class="form-row mt-3">
          <div class="col-12">
            <div class="alertMessage text-center" role="alert"></div>
          </div>
        </div>

        <!-- Google Maps -->
        <!-- <iframe id="gmaps" class="card shadow border-0" width="100%" height="500px" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDTFFrlgMNcm4J0uJixFbI5U9pIYDayUmY
        &q=Space+Needle,Seattle+WA&maptype=roadmap&language=en" allowfullscreen>
        </iframe> -->
        <div class="card shadow border-0 p-4 mb-4" id="gmaps"></div>
      </div>

      <div class="col-md-8">
        <div class="row mb-2" id="recommended-routes"></div>
        <div class="row">
          <div class="col-md-6 col-sm-6" id="routes-index-col-2">
            <!-- <div class='card mb-5 ml-3 shadow border-0 route-card'>
          <div class='card-body route-card-image'>
            <img class="route-card-img" src="duck.jpg" width="100%"/>
          </div>
          <div class='card-body'>
            <div class='route-card-title'>
              <h5>TITLE</h5>
            </div>
            <div class='username-group'>
              <img src="icons/person-circle.svg" alt="username-person" width='24' height='24'>
              <p class="mb-0" id="route-card-username">username</p>
            <div class='route-likes float-right'>
              <img src='icons/heart.svg' width='18' height='18'>
              <p id='route-number-likes'>36 Likes</p>
            </div>
            </div>
            <div class='route-card-contents mt-2'>
              <ol>
                <li class='route-contents-list'>asssdsdajnldl</li>
                <li class='route-contents-list'>sadasdasdasd</li>
                <li class='route-contents-list'>sdadasdasggr</li>
              </ol>
            </div>
            <div class='route-card-icons'>
              <span class=icon-ramp aria-hidden='true' id='icon-ramp'></span>
              <span class=icon-elevator aria-hidden='true' id='icon-elevator'></span>
              <span class=icon-wheelchair aria-hidden='true' id='icon-wheelchair'></span>
            </div>
            </div>
            <div class='card-footer route-card-blue'>
              <img src='icons/chevron-right.svg' class='chevron-icon float-right' alt='more_information' style='border:none;' width='24' height='24'>
            </div>
        </div> -->

          </div>

          <div class="col-md-6 col-sm-6" id="routes-index-col-3">

          </div>
        </div>
      </div>
    </div>
    <div class="text-center" id="no_result">
      <img src="icons/sadsmiley.png" style="width: 12rem;" class="mx-auto mb-4">
      <!-- Image from https://www.kissclipart.com/ -->
      <h4>No result to show... Perhaps try looking for other routes?</h4>
    </div>

  </div>

  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

  <!-- Firebase Realtime Database -->
  <script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-storage.js"></script>

  <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyDTFFrlgMNcm4J0uJixFbI5U9pIYDayUmY",
      authDomain: "wheeloninthistogether123.firebaseapp.com",
      databaseURL: "https://wheeloninthistogether123.firebaseio.com",
      projectId: "wheeloninthistogether123",
      storageBucket: "wheeloninthistogether123.appspot.com",
      messagingSenderId: "728495178731",
      appId: "1:728495178731:web:06792b904ccd5693b2cfae",
      measurementId: "G-2SRFF7XTB2"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
  </script>

  <!-- Javascript -->
  <script src="scripts/new_navbar.js"></script>
  <script src="scripts/routes.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $("#no_result").hide();
      if (window.location.hash) {
        var location = window.location.hash;
        var splithash = location.split('#');
        var id = splithash[1];

        var query = routesRef.orderByKey().equalTo(id);
        query.once('value').then(function(snapshot) {
          snapshot.forEach(function(childSnapshot) {
            var from_db = childSnapshot.val().from;
            var to_db = childSnapshot.val().to;
            document.getElementById("fromPlace").value = from_db;
            document.getElementById("toPlace").value = to_db;
            $("#searchRouteButton").click();

            //Thank you https://www.tutorialspoint.com/how-to-remove-the-hash-from-window-location-url-with-javascript-without-page-refresh#:~:text=location%20(URL)%20with%20JavaScript%20without%20page%20refresh%3F,-JavascriptFront%20End&text=You%20can%20use%20the%20replaceState,passed%20in%20the%20method%20parameters.
            history.replaceState(null, null, ' ');
          });
          $(".spinner").hide();
        })
      } else {
        $("#recommended-routes").append("<h4 id='recommended-routes-text'>Not sure where to go? Check out our recommended routes!</h4>");
        var dataList = [];
        var query = routesRef.orderByKey();
        query.limitToFirst(2).once('value').then(function(snapshot) {
          snapshot.forEach(function(childSnapshot) {
            var from_db = childSnapshot.val().from;
            var to_db = childSnapshot.val().to;
            var pushid = childSnapshot.key;
            var likes_db = childSnapshot.val().likes;
            var title_db = childSnapshot.val().title;
            var username_db = childSnapshot.val().username;
            var ramp_db = childSnapshot.val().ramp;
            var elevator_db = childSnapshot.val().elevator;
            var wheelchair_db = childSnapshot.val().wheelchair;
            var description_db = childSnapshot.val().desc;
            var images_db = childSnapshot.val().images;
            var liked = childSnapshot.val().z_liked;

            var imagesList = [];

            for (var i in images_db) {
              imagesList.push(images_db[i]);
            }

            dataList.push([pushid, imagesList, title_db, username_db, likes_db, description_db, ramp_db, elevator_db, wheelchair_db, liked]);
          });
          for (var i = 0; i < (dataList.length); i++) {
            loadCard(dataList[i][0], dataList[i][1], dataList[i][2], dataList[i][3], dataList[i][4], dataList[i][5], dataList[i][6], dataList[i][7], dataList[i][8], dataList[i][9], i);
          }
          $(".route-card").addClass("fromIndex");
          $(".spinner").hide();
        })
      }
    })
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTFFrlgMNcm4J0uJixFbI5U9pIYDayUmY&callback=initMap">
  </script>

</body>

</html>
